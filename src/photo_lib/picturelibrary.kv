#:kivy 2.1.0

<ScrollLabel>:
    lbl: lab
    always_overscroll: False
    effect_cls: "ScrollEffect"
    # smooth_scroll_end: 5
    smooth_scroll_end: 0

    canvas.before:
        Color:
            rgb: self.background_col
        Rectangle:
            pos: self.pos[0], self.pos[1]
            size: self.size[0], self.size[1]

    Label:
        id: lab
        text: self.parent.text
        font_size: 18
        text_size: None, None
        size_hint_x: None
        size_hint_y: None
        width: self.texture_size[0]
        height: self.texture_size[1]

<MetadataScrollLabel>:
    lbl: lab
    effect_cls: "ScrollEffect"
    always_overscroll: False
    # smooth_scroll_end: 5
    smooth_scroll_end: 0

    Label:
        id: lab
        text: self.parent.text
        font_size: 18
        text_size: None, None
        size_hint_x: None
        size_hint_y: None
        width: self.texture_size[0]
        height: self.texture_size[1]

<PathScrollLabel>:
    lbl: lab
    # effect_cls: "ScrollEffect"
    always_overscroll: False
    effect_cls: "ScrollEffect"
    # smooth_scroll_end: 5
    smooth_scroll_end: 0

    Label:
        id: lab
        text: self.parent.text
        font_size: 18
        text_size: None, None
        size_hint_x: None
        size_hint_y: None
        width: self.texture_size[0]
        height: self.texture_size[1]

<ComparePane>:
    width: 400
    size_hint_y: 1.0
    # size_hint_x: 1.0
    size_hint_x: None


    image: img
    dump: dlt_btn
    rename_file: rnf_btn
    l_ofname: label_original_file_name
    l_ofpath: label_original_file_path
    l_naming_tag: label_naming_tag
    l_new_name: label_new_name
    # l_binary_comp: label_binary_comparison
    l_metadata: label_metadata
    obuton: origin_btn
    mark_delete_button: dlt_btn
    l_file_size: file_size_tag

    canvas:
        Color:
            rgb: (0.2, 0.2, 0.2)
        Rectangle:
            pos: self.pos[0]+3, self.pos[1]+3
            size: self.size[0] - 6, self.size[1] - 6

    GridLayout:
        pos: self.parent.pos
        spacing: 10
        padding: 10
        size: self.parent.size
        cols: 1

        ImageButton:
            id: img
            size_hint_x: 1.0
            size_hint_y: None
            height: self.width / self.image_ratio
            source: self.parent.parent.image_path
            on_press:self.parent.parent.open_image_popup()

        ScrollLabel:
            id: label_original_file_name
            size_hint: 1.0, None
            text: self.parent.parent.org_fname
            height: 25
            do_scroll_y: False

        PathScrollLabel:
            id: label_original_file_path
            size_hint: 1.0, None
            height: 25
            do_scroll_y: False
            text: self.parent.parent.org_fpath
            scroll_x: 1.0

        ScrollLabel:
            id: label_naming_tag
            height: 25
            size_hint: 1.0, None
            do_scroll_y: False
            text: self.parent.parent.naming_tag


        ScrollLabel:
            id: label_new_name
            size_hint: 1.0, None
            height: 25
            do_scroll_y: False
            text: self.parent.parent.new_name

        ScrollLabel:
            id: file_size_tag
            height: 25
            size_hint: 1.0, None
            height: 25
            do_scroll_y: False
            text: self.parent.parent.file_size

        BoxLayout:
            size_hint: 1.0, None
            orientation: 'horizontal'
            height: 30

            Button:
                id: rnf_btn
                size_hint: 1.0, None
                height: 30
                text: "Change Date"
                # background_normal: ''
                on_press: self.parent.parent.parent.open_modal()

            ToggleButton:
                id: dlt_btn
                size_hint: 1.0, None
                height: 30
                text: "keep"
                background_normal: ''
                background_color: 0.2, 0.6, 0.2
                on_press: self.parent.parent.parent.set_button_color()

            ToggleButton:
                id: origin_btn
                group: "origin"
                text: "main"
                size_hint: 1.0, None
                height: 30
                on_press: self.parent.parent.parent.set_delete_on_main()


        MetadataScrollLabel:
            id: label_metadata
            size_hint_x: 1.0
            multiline: True
            text: self.parent.parent.metadata



<RootWidget>:
    BoxLayout:
        orientation: 'horizontal'
        pos_hint: {'bottom': 1.0, 'left': 1.0}
        size_hint_y: None
        height: 40
        size_hint_x: None
        width: self.parent.width


        canvas:
            Color:
                rgb: (0.2, 0.2, 0.2)
            Rectangle:
                pos: self.pos[0], self.pos[1]
                size: self.size[0], self.size[1]

        Button:
            text: "Load first"
            font_size: 18
            size_hint_y: None
            size_hint_x: None
            size: 100, 40
            on_press: self.parent.parent.db_selector_widget.open()

        Label:
            id: status
            font_size: 18
            size_hint_y: None
            size_hint_x: None
            height:  40
            width:  self.parent.width - 400
            text: "Set 1 of 100"

        Button:
            text: "Compare Files"
            font_size: 18
            size_hint_y: None
            size_hint_x: None
            size: 200, 40
            # on_press: print("TEST")
            on_press: self.parent.parent.file_compare_modal.open()

        Button:
            text: "done"
            font_size: 18
            size_hint_y: None
            size_hint_x: None
            size: 100, 40
            # on_press: print("TEST")
            on_press: self.parent.parent.store_load_entry()




<CompareScroller>:
    do_scroll_y: False
    do_scroll_x: True
    flexbox: cg
    effect_cls: "ScrollEffect"
    always_overscroll: False
    # smooth_scroll_end: 5
    smooth_scroll_end: 0

    canvas.before:
        Color:
            rgb: self.background_col
        Rectangle:
            pos: self.pos[0], self.pos[1]
            size: self.size[0], self.size[1]

    FlexibleBox:
        orientation: 'vertical'
        size_hint_x: None

        MyGrid:
            id: cg
            rows: 1
            size_hint: None, 1.0

        Widget:
            size_hint_x: None
            size_hint_y: None
            height: 40

<SetDateModal>:
    id: ChangeDateModal
    customDateTag: naming_tag_input
    customDateTimeInput: datetime_input

    pos_hint: {'center_x': 0.5, 'center_y': 0.5}
    size_hint: None, None
    height: 200
    width: 500
    auto_dismiss: True

    GridLayout:
        cols: 2
        Label:
            id: naming_tag
            text: "Source Tag"
            font_size: 18

        CustomDateTag:
            multiline: False
            id: naming_tag_input
            font_size: 18

        Label:
            id: datetime_label
            text: "Custom Datetime"
            font_size: 18

        TextInput:
            id: datetime_input
            hint_text: "YYYY-MM-DD HH.MM.SS"
            font_size: 18
            disabled: True

        Button:
            id: cls_btn
            text: "Apply"
            disabled: False
            size_hint_y: None
            height: self.texture_size[1] + 40
            on_press: self.parent.parent.apply()

        Button:
            id: apl_btn
            text: "Apply and remove from view"
            size_hint_y: None
            height: self.texture_size[1] + 40
            # on_press: self.parent.parent.apply_close()
            on_press: self.parent.parent.apply_close()


<ErrorPopup>:
    size_hint: 0.8, 0.8
    # size: 400, 400
    title: "ERROR"


    BoxLayout:
        size_hint: 1.0, 1.0
        id: layout
        orientation: 'vertical'

        Label:
            size_hint: 1.0, None
            height: self.texture_size[1] + 40
            text: self.parent.parent.parent.parent.error_msg

        ToggleButton:
            id: show_btn
            size_hint: 1.0, None
            height: 40
            text: "Show Traceback"
            on_press: self.parent.parent.parent.parent.trigger_traceback()

<TracebackWidget>:
    size_hint: 1.0, None
    height: self.texture_size[1] + 40

<DuplicateLocation>:
    title: "Drop the previously computed duplicates table?"
    size_hint: 0.6, 0.2
    reuse_button: reuse
    recompute_button: recompute

    BoxLayout:
        orientation: "horizontal"
        size_hint: 1.0, None
        height: 40

        Button:
            id: reuse
            text: "Use existing duplicates"
            size_hint: 1.0, 1.0

        Button:
            id: recompute
            text: "Compute new duplicates"
            size_hint: 1.0, 1.0


<DuplicateDetection>:
    title: "Select the Method with which the duplicates are supposed to be detected."
    size_hint: 0.6, 0.6
    reuse_button: reuse
    recompute_button: recompute

    BoxLayout:
        orientation: "vertical"
        size_hint: 1.0, 1.0
        height: 40

        Button:
            id: reuse
            text: "Duplicates based on file_hashes"
            size_hint: 1.0, 1.0
            on_press: self.parent.parent.parent.parent.hash_based()

        Button:
            id: recompute
            text: "Duplicates based on rgb, day (fastest)"
            size_hint: 1.0, 1.0
            on_press: self.parent.parent.parent.parent.difpy_based(time_span="day")

        Button:
            id: recompute
            text: "Duplicates based on rgb, month (faster)"
            size_hint: 1.0, 1.0
            on_press: self.parent.parent.parent.parent.difpy_based(time_span="month")

        Button:
            id: recompute
            text: "Duplicates based on rgb, year (slower)"
            size_hint: 1.0, 1.0
            on_press: self.parent.parent.parent.parent.difpy_based(time_span="year")

        Button:
            id: recompute
            text: "Duplicates based on rgb, global (slowest)"
            size_hint: 1.0, 1.0
            on_press: self.parent.parent.parent.parent.difpy_based(time_span="all")


# nice label:
#         Label:
#             size_hint: None, None
#             font_size: 18
#             text_size: None, None
#             width: self.texture_size[0]
#             height: self.texture_size[1]
#             text: "IMG_2162.JPG"
