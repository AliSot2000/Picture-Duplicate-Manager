#:kivy 2.1.0

<ScrollLabel>:
    lbl: lab

    Label:
        id: lab
        text: self.parent.text
        font_size: 18
        text_size: None, None
        size_hint_x: None
        size_hint_y: None
        width: self.texture_size[0]
        height: self.texture_size[1]

<MetadataScrollLabel>:
    lbl: lab
    # effect_cls: "ScrollEffect"

    Label:
        id: lab
        text: self.parent.text
        font_size: 18
        text_size: None, None
        size_hint_x: None
        size_hint_y: None
        width: self.texture_size[0]
        height: self.texture_size[1]

<PathScrollLabel>:
    lbl: lab
    # effect_cls: "ScrollEffect"

    Label:
        id: lab
        text: self.parent.text
        font_size: 18
        text_size: None, None
        size_hint_x: None
        size_hint_y: None
        width: self.texture_size[0]
        height: self.texture_size[1]

<ComparePane>:

    size_hint_x: None
    width: 400
    size_hint_y: 1.0

    image: img
    dump: dlt_btn
    rename_file: rnf_btn
    l_ofname: label_original_file_name
    l_ofpath: label_original_file_path
    l_naming_tag: label_naming_tag
    l_new_name: label_new_name
    # l_binary_comp: label_binary_comparison
    l_metadata: label_metadata

    canvas:
        Color:
            rgb: (0.2, 0.2, 0.2)
        Rectangle:
            pos: self.pos[0]+3, self.pos[1]+3
            size: self.size[0] - 6, self.size[1] - 6

    GridLayout:
        pos: self.parent.pos
        spacing: 10
        padding: 10
        size: self.parent.size
        cols: 1

        Image:
            id: img
            size_hint_x: 1.0
            size_hint_y: None
            height: self.width / self.image_ratio
            source: self.parent.parent.image_path

        ScrollLabel:
            id: label_original_file_name
            size_hint: 1.0, None
            text: self.parent.parent.org_fname
            height: 25
            do_scroll_y: False

        PathScrollLabel:
            id: label_original_file_path
            size_hint: 1.0, None
            height: 25
            do_scroll_y: False
            text: self.parent.parent.org_fpath
            scroll_x: 1.0

        ScrollLabel:
            id: label_naming_tag
            height: 25
            size_hint: 1.0, None
            do_scroll_y: False
            text: self.parent.parent.naming_tag


        ScrollLabel:
            id: label_new_name
            size_hint: 1.0, None
            height: 25
            do_scroll_y: False
            text: self.parent.parent.new_name

        BoxLayout:
            size_hint: 1.0, None
            orientation: 'horizontal'
            height: 30

            Button:
                id: rnf_btn
                size_hint: 1.0, None
                height: 30
                text: "Change Date"
                # background_normal: ''
                on_press: self.parent.parent.parent.open_modal()

            ToggleButton:
                id: dlt_btn
                size_hint: 1.0, None
                height: 30
                text: "Keep"
                background_normal: ''
                background_color: 0.2, 0.6, 0.2
                on_press: self.parent.parent.parent.set_button_color()

            ToggleButton:
                id: origin_btn
                group: "origin"
                text: "main"
                size_hint: 1.0, None
                height: 30


        MetadataScrollLabel:
            id: label_metadata
            size_hint_x: 1.0
            multiline: True
            text: self.parent.parent.metadata



<MyFloat>:

    Button:
        pos_hint: {'bottom': 1.0, 'right': 1.0}
        text: "done"
        font_size: 18
        size_hint_y: None
        size_hint_x: None
        size: 100, 40

    BoxLayout:
        orientation: 'horizontal'
        pos_hint: {'bottom': 1.0, 'left': 1.0}

        Button:
            text: "Load first"
            font_size: 18
            size_hint_y: None
            size_hint_x: None
            size: 100, 40
            on_press: self.parent.parent.db_selector_widget.open()

        Label:
            id: status
            font_size: 18
            size_hint_y: None
            size_hint_x: None
            height:  40
            width:  self.texture_size[0]+40
            text: "Set 1 of 100"


<CompareScroller>:
    do_scroll_y: True
    do_scroll_x: True
    flexbox: cg

    FlexibleBox:
        orientation: 'vertical'
        size_hint_x: None

        MyGrid:
            id: cg
            rows: 1
            size_hint: None, 1.0

        Widget:
            size_hint_x: None
            size_hint_y: None
            height: 40

<SetDateModal>:
    id: ChangeDateModal
    customDateTag: naming_tag_input
    customDateTimeInput: datetime_input

    pos_hint: {'center_x': 0.5, 'center_y': 0.5}
    size_hint: None, None
    height: 200
    width: 500
    auto_dismiss: True

    GridLayout:
        cols: 2
        Label:
            id: naming_tag
            text: "Source Tag"
            font_size: 18

        CustomDateTag:
            multiline: False
            id: naming_tag_input
            font_size: 18

        Label:
            id: datetime_label
            text: "Custom Datetime"
            font_size: 18

        TextInput:
            id: datetime_input
            hint_text: "YYYY-MM-DD HH.MM.SS"
            font_size: 18
            disabled: True

        Button:
            id: cls_btn
            text: "Don't Apply"
            disabled: False
            size_hint_y: None
            height: self.texture_size[1] + 40
            on_press: self.parent.parent.dismiss()

        Button:
            id: apl_btn
            text: "Apply New Source Tag"
            size_hint_y: None
            height: self.texture_size[1] + 40
            # on_press: self.parent.parent.apply_close()
            on_press: self.parent.parent.apply_close()


<ErrorPopup>:
    size_hint: 0.8, 0.8
    # size: 400, 400
    title: "ERROR"


    BoxLayout:
        size_hint: 1.0, 1.0
        id: layout
        orientation: 'vertical'

        Label:
            size_hint: 1.0, None
            height: self.texture_size[1] + 40
            text: self.parent.parent.parent.parent.error_msg

        ToggleButton:
            id: show_btn
            size_hint: 1.0, None
            height: 40
            text: "Show Traceback"
            on_press: self.parent.parent.parent.parent.trigger_traceback()

<TracebackWidget>:
    size_hint: 1.0, None
    height: self.texture_size[1] + 40

<DatabaseSelector>:
    fc: file_selector
    size_hint: 0.8, 0.8


    BoxLayout:
        orientation: 'vertical'
        size_hint: 1.0, 1.0

        FileChooserIconView:
            id: file_selector
            size_hint: None, 1.0
            width: self.parent.parent.parent.width

        BoxLayout:
            orientation: 'horizontal'

            size_hint: 1.0, None
            height: 50
            Label:
                id: status
                height: 40
                size_hint: 0.8, None

            Button:
                size_hint: 0.2, None
                height: 40
                text: "Confirm Folder"
                on_press: self.parent.parent.parent.parent.parent.apply_db()

<DuplicateLocation>:
    title: "Drop the previously computed duplicates table?"
    size_hint: 0.6, 0.2
    reuse_button: reuse
    recompute_button: recompute

    BoxLayout:
        orientation: "horizontal"
        size_hint: 1.0, None
        height: 40

        Button:
            id: reuse
            text: "Use existing duplicates"
            size_hint: 1.0, 1.0

        Button:
            id: recompute
            text: "Compute new duplicates"
            size_hint: 1.0, 1.0


<DuplicateDetection>:
    title: "Select the Method with which the duplicates are supposed to be detected."
    size_hint: 0.6, 0.6
    reuse_button: reuse
    recompute_button: recompute

    BoxLayout:
        orientation: "vertical"
        size_hint: 1.0, 1.0
        height: 40

        Button:
            id: reuse
            text: "Duplicates based on file_hashes"
            size_hint: 1.0, 1.0
            on_press: self.parent.parent.parent.parent.hash_based()

        Button:
            id: recompute
            text: "Duplicates based on rgb, day (fastest)"
            size_hint: 1.0, 1.0
            on_press: self.parent.parent.parent.parent.difpy_based(time_span="day")

        Button:
            id: recompute
            text: "Duplicates based on rgb, month (faster)"
            size_hint: 1.0, 1.0
            on_press: self.parent.parent.parent.parent.difpy_based(time_span="month")

        Button:
            id: recompute
            text: "Duplicates based on rgb, year (slower)"
            size_hint: 1.0, 1.0
            on_press: self.parent.parent.parent.parent.difpy_based(time_span="year")

        Button:
            id: recompute
            text: "Duplicates based on rgb, global (slowest)"
            size_hint: 1.0, 1.0
            on_press: self.parent.parent.parent.parent.difpy_based(time_span="all")


<ProgressInfo>:
    title: "Search Progress"
    size_hint: 0.5, 0.1
    prog_bar: prog_bar

    ProgressBar:
        max: 100
        value: 0
        id: prog_bar
        size_hint: 1.0, 1.0
        pos_hint: {'center_x': 0.5, 'center_y': 0.5}



# nice label:
#         Label:
#             size_hint: None, None
#             font_size: 18
#             text_size: None, None
#             width: self.texture_size[0]
#             height: self.texture_size[1]
#             text: "IMG_2162.JPG"
